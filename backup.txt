from dash_html import plot_candle , plot_finance ,get_sec_indus
import sys

import plotly.graph_objects as go
from PyQt5.QtCore import QUrl
from PyQt5.QtWebEngineWidgets import QWebEngineView
from PyQt5 import QtWidgets
from PyQt5 import QtCore, QtWidgets
from PyQt5.QtGui import QFont
from dash import dcc
from dash import html
import dash
import sys     
import threading

app_dash = dash.Dash()  
app_dash2 = dash.Dash()  

class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        font = QFont()
        font.setPointSize(9)
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(1267, 758)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")

        self.pushButton = QtWidgets.QPushButton(self.centralwidget)
        self.pushButton.setGeometry(QtCore.QRect(190, 60, 41, 21))
        self.pushButton.setObjectName("pushButton")

        self.lineEdit = QtWidgets.QLineEdit(self.centralwidget)
        self.lineEdit.setGeometry(QtCore.QRect(40, 60, 141, 22))
        self.lineEdit.setObjectName("lineEdit")
        self.lineEdit.returnPressed.connect(lambda : self.change_stock_graph(self.lineEdit.text()))
        self.pushButton.clicked.connect(lambda : self.change_stock_graph(self.lineEdit.text()))

        self.symbolTopic = QtWidgets.QLabel(self.centralwidget)
        self.symbolTopic.setGeometry(QtCore.QRect(340, 30, 91, 31))
        self.symbolTopic.setObjectName("symbolTopic")
        self.symbolTopic.setFont(font)
        self.symbolName = QtWidgets.QLabel(self.centralwidget)
        self.symbolName.setGeometry(QtCore.QRect(410, 30, 400, 31))
        self.symbolName.setObjectName("symbolName")
        self.symbolName.setFont(font)
        self.sectorTopic = QtWidgets.QLabel(self.centralwidget)
        self.sectorTopic.setGeometry(QtCore.QRect(340, 60, 91, 31))
        self.sectorTopic.setObjectName("sectorTopic")
        self.sectorTopic.setFont(font)
        self.sectorName = QtWidgets.QLabel(self.centralwidget)
        self.sectorName.setGeometry(QtCore.QRect(410, 60, 400, 31))
        self.sectorName.setObjectName("sectorName")
        self.sectorName.setFont(font)
        self.industryTopic = QtWidgets.QLabel(self.centralwidget)
        self.industryTopic.setGeometry(QtCore.QRect(340, 90, 121, 31))
        self.industryTopic.setObjectName("industryTopic")
        self.industryTopic.setFont(font)
        self.industryName = QtWidgets.QLabel(self.centralwidget)
        self.industryName.setGeometry(QtCore.QRect(410, 90, 400, 31))
        self.industryName.setObjectName("industryName")
        self.industryName.setFont(font)

        self.label = QtWidgets.QLabel(self.centralwidget)
        self.label.setGeometry(QtCore.QRect(50, 40, 121, 20))
        self.label.setObjectName("label")

        self.lineEdit_2 = QtWidgets.QLineEdit(self.centralwidget)
        self.lineEdit_2.setGeometry(QtCore.QRect(1030, 60, 171, 22))
        self.lineEdit_2.setObjectName("lineEdit_2")

        self.pushButton_2 = QtWidgets.QPushButton(self.centralwidget)
        self.pushButton_2.setGeometry(QtCore.QRect(1210, 60, 41, 21))
        self.pushButton_2.setObjectName("pushButton_2")
       # self.pushButton.clicked.connect(lambda : self.change_stock_graph(self.lineEdit.text()))

        self.label_3 = QtWidgets.QLabel(self.centralwidget)
        self.label_3.setGeometry(QtCore.QRect(1060, 20, 111, 21))
        self.label_3.setObjectName("label_3")

        self.label_4 = QtWidgets.QLabel(self.centralwidget)
        self.label_4.setGeometry(QtCore.QRect(1050, 40, 131, 21))
        self.label_4.setObjectName("label_4")

        self.tabWidget = QtWidgets.QTabWidget(self.centralwidget)
        self.tabWidget.setGeometry(QtCore.QRect(20, 100, 1231, 611))
        self.tabWidget.setObjectName("tabWidget")

        self.tab = QtWidgets.QWidget()
        self.tab.setObjectName("tab")

        self.label_2 = QtWidgets.QLabel(self.tab)
        self.label_2.setGeometry(QtCore.QRect(20, 10, 61, 20))
        self.label_2.setObjectName("label_2")

        self.comboBox = QtWidgets.QComboBox(self.tab)
        self.comboBox.setGeometry(QtCore.QRect(10, 30, 81, 22))
        self.comboBox.setObjectName("comboBox")
        self.comboBox.addItem("Hourly")
        self.comboBox.addItem("Daily")
        self.comboBox.addItem("Monthly")
        self.comboBox.addItem("Quarterly")
        self.comboBox.setCurrentIndex(-1)
        self.comboBox.currentIndexChanged.connect(self.change_interval)

        self.fig=QWebEngineView(self.tab)
        self.fig.load(QUrl("http://localhost:8050"))
        self.fig.setGeometry(QtCore.QRect(10, 60, 1201, 511))
        self.fig.setObjectName("fig")

        self.tabWidget.addTab(self.tab, "")

        self.tab_2 = QtWidgets.QWidget()
        self.tab_2.setObjectName("tab_2")

        self.fig2=QWebEngineView(self.tab_2)
        self.fig2.load(QUrl("http://localhost:8051"))
        self.fig2.setGeometry(QtCore.QRect(10, 50, 1201, 521))
        self.fig2.setObjectName("fig2")

        self.label_5 = QtWidgets.QLabel(self.tab_2)
        self.label_5.setGeometry(QtCore.QRect(20, 20, 91, 16))
        self.label_5.setObjectName("label_5")

        self.comboBox2 = QtWidgets.QComboBox(self.tab_2)
        self.comboBox2.setGeometry(QtCore.QRect(140, 20, 101, 22))
        self.comboBox2.setObjectName("comboBox2")
        self.comboBox2.addItem("Total Asset")
        self.comboBox2.addItem("Net Profit")
        self.comboBox2.addItem("Dividend Yield")
        self.comboBox2.addItem("Revenue")
        self.comboBox2.addItem("ROA & ROE")
        self.comboBox2.setCurrentIndex(-1)
        self.comboBox2.currentIndexChanged.connect(self.change_finance)

        self.tabWidget.addTab(self.tab_2, "")

        MainWindow.setCentralWidget(self.centralwidget)

        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 1267, 21))
        self.menubar.setObjectName("menubar")
        MainWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(MainWindow)
        self.statusbar.setObjectName("statusbar")
        MainWindow.setStatusBar(self.statusbar)

        self.retranslateUi(MainWindow)
        self.tabWidget.setCurrentIndex(0)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def change_finance(self,index):
        if index == 0:
            # do something for "Option 1"
            app_dash2.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_finance['Total Asset'][0])
        ])
        elif index == 1:
            # do something for "Option 2"
            app_dash2.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_finance['Net Profit'][0])
        ])
        elif index == 2:
            # do something for "Option 3"
            app_dash2.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_finance['Dividend Yield'][0])
        ])
        elif index == 3:
            # do something for "Option 4"
            app_dash2.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_finance['Revenue'][0])
        ])
        elif index == 4:
            # do something for "Option 5"
            app_dash2.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_finance['ROA & ROE'][0])
        ])
        self.fig2.reload()
    

    def change_interval(self,index):
        if index == 0:
            # do something for "Option 1"
            app_dash.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_candle['Hourly'])
        ])
        elif index == 1:
            # do something for "Option 2"
            app_dash.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_candle['Daily'])
        ])
        elif index == 2:
            # do something for "Option 3"
            app_dash.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_candle['Monthly'])
        ])
        elif index == 3:
            # do something for "Option 3"
            app_dash.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_candle['Quarterly'])
        ])
        self.fig.reload()

    def change_stock_graph(self,word):
        self.lineEdit.clear()
        self.pic_candle = plot_candle(word)
        self.pic_finance = plot_finance(word)
        self.comboBox.setCurrentIndex(0)
        self.comboBox2.setCurrentIndex(0)
        sector,industry = get_sec_indus(word)
        self.symbolName.setText(word)
        self.sectorName.setText(sector)
        self.industryName.setText(industry)
        app_dash.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_candle['Hourly'])
        ])
        app_dash2.layout = html.Div([
            dcc.Graph(id='graph', figure=self.pic_finance['Total Asset'][0])
        ])
        self.fig.reload()
        self.fig2.reload()

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.symbolTopic.setText(_translate("MainWindow", "Symbol : "))
        self.symbolName.setText(_translate("MainWindow", ""))
        self.sectorTopic.setText(_translate("MainWindow", "Sector : "))
        self.sectorName.setText(_translate("MainWindow", ""))
        self.industryTopic.setText(_translate("MainWindow", "Industry : "))
        self.industryName.setText(_translate("MainWindow", ""))

        self.pushButton.setText(_translate("MainWindow", "Enter"))
        self.label.setText(_translate("MainWindow", "Enter Stock Symbol"))
        self.pushButton_2.setText(_translate("MainWindow", "Enter"))
        self.label_3.setText(_translate("MainWindow", "Enter stock symbol"))
        self.label_4.setText(_translate("MainWindow", "to update lastest price"))
        self.label_2.setText(_translate("MainWindow", "Frequency"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab), _translate("MainWindow", "Price"))
        self.label_5.setText(_translate("MainWindow", "Financial statement"))
        self.tabWidget.setTabText(self.tabWidget.indexOf(self.tab_2), _translate("MainWindow", "Financial Statement"))


def run_dash_server():
    app_dash.layout = html.Div([
        dcc.Graph(id='graph', figure=go.Figure())
    ])
    app_dash.run_server(debug=True, use_reloader=False,port=8050)

def run_dash_server2():
    app_dash2.layout = html.Div([
        dcc.Graph(id='graph', figure=go.Figure())
    ])
    app_dash2.run_server(debug=True, use_reloader=False,port=8051)

if __name__ == "__main__":
    app_ui = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    
    dash_thread = threading.Thread(target=run_dash_server)
    dash_thread2 = threading.Thread(target=run_dash_server2)
    dash_thread.start()
    dash_thread2.start()
    sys.exit(app_ui.exec_())

# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'C:\Work\CprE\Year2\Semester2\Software Dav II\test.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtCore import QUrl
from PyQt5.QtWebEngineWidgets import QWebEngineView

class Ui_MainWindow(object):
    def setupUi(self, MainWindow):
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(1600, 892)
        MainWindow.setToolTipDuration(-1)
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.gridLayout_2 = QtWidgets.QGridLayout(self.centralwidget)
        self.gridLayout_2.setObjectName("gridLayout_2")
        self.widget = QtWidgets.QWidget(self.centralwidget)
        self.widget.setObjectName("widget")
        self.verticalLayout_9 = QtWidgets.QVBoxLayout(self.widget)
        self.verticalLayout_9.setObjectName("verticalLayout_9")
        self.verticalLayout_8 = QtWidgets.QVBoxLayout()
        self.verticalLayout_8.setObjectName("verticalLayout_8")
        self.verticalLayout = QtWidgets.QVBoxLayout()
        self.verticalLayout.setObjectName("verticalLayout")
        spacerItem = QtWidgets.QSpacerItem(20, 40, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Expanding)
        self.verticalLayout.addItem(spacerItem)
        self.horizontalLayout_12 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_12.setObjectName("horizontalLayout_12")
        spacerItem1 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.horizontalLayout_12.addItem(spacerItem1)
        self.label_3 = QtWidgets.QLabel(self.widget)
        self.label_3.setObjectName("label_3")
        self.horizontalLayout_12.addWidget(self.label_3)
        spacerItem2 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.horizontalLayout_12.addItem(spacerItem2)
        self.verticalLayout.addLayout(self.horizontalLayout_12)
        spacerItem3 = QtWidgets.QSpacerItem(20, 40, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Expanding)
        self.verticalLayout.addItem(spacerItem3)
        self.verticalLayout.setStretch(0, 1)
        self.verticalLayout.setStretch(1, 2)
        self.verticalLayout.setStretch(2, 1)
        self.verticalLayout_8.addLayout(self.verticalLayout)
        self.verticalLayout_7 = QtWidgets.QVBoxLayout()
        self.verticalLayout_7.setObjectName("verticalLayout_7")
        self.button_overall_page = QtWidgets.QPushButton(self.widget)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_overall_page.setFont(font)
        self.button_overall_page.setCheckable(True)
        self.button_overall_page.setChecked(True)
        self.button_overall_page.setAutoExclusive(True)
        self.button_overall_page.setObjectName("button_overall_page")
        self.verticalLayout_7.addWidget(self.button_overall_page)
        self.button_stock_page = QtWidgets.QPushButton(self.widget)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_stock_page.setFont(font)
        self.button_stock_page.setCheckable(True)
        self.button_stock_page.setAutoExclusive(True)
        self.button_stock_page.setObjectName("button_stock_page")
        self.verticalLayout_7.addWidget(self.button_stock_page)
        self.button_update_page = QtWidgets.QPushButton(self.widget)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_update_page.setFont(font)
        self.button_update_page.setCheckable(True)
        self.button_update_page.setAutoExclusive(True)
        self.button_update_page.setObjectName("button_update_page")
        self.verticalLayout_7.addWidget(self.button_update_page)
        self.button_financial_page = QtWidgets.QPushButton(self.widget)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_financial_page.setFont(font)
        self.button_financial_page.setCheckable(True)
        self.button_financial_page.setAutoExclusive(True)
        self.button_financial_page.setObjectName("button_financial_page")
        self.verticalLayout_7.addWidget(self.button_financial_page)
        self.button_trending_page = QtWidgets.QPushButton(self.widget)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_trending_page.setFont(font)
        self.button_trending_page.setObjectName("button_trending_page")
        self.verticalLayout_7.addWidget(self.button_trending_page)
        self.verticalLayout_8.addLayout(self.verticalLayout_7)
        spacerItem4 = QtWidgets.QSpacerItem(17, 558, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Expanding)
        self.verticalLayout_8.addItem(spacerItem4)
        self.verticalLayout_8.setStretch(0, 1)
        self.verticalLayout_8.setStretch(1, 1)
        self.verticalLayout_8.setStretch(2, 6)
        self.verticalLayout_9.addLayout(self.verticalLayout_8)
        self.gridLayout_2.addWidget(self.widget, 0, 0, 1, 1)
        self.widget_2 = QtWidgets.QWidget(self.centralwidget)
        self.widget_2.setEnabled(True)
        self.widget_2.setMaximumSize(QtCore.QSize(1801, 1036))
        self.widget_2.setAutoFillBackground(False)
        self.widget_2.setObjectName("widget_2")
        self.verticalLayout_4 = QtWidgets.QVBoxLayout(self.widget_2)
        self.verticalLayout_4.setContentsMargins(0, 0, 7, 0)
        self.verticalLayout_4.setObjectName("verticalLayout_4")
        self.widget_3 = QtWidgets.QWidget(self.widget_2)
        self.widget_3.setObjectName("widget_3")
        self.horizontalLayout_10 = QtWidgets.QHBoxLayout(self.widget_3)
        self.horizontalLayout_10.setContentsMargins(7, 7, 7, 7)
        self.horizontalLayout_10.setObjectName("horizontalLayout_10")
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_2.setSizeConstraint(QtWidgets.QLayout.SetDefaultConstraint)
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        spacerItem5 = QtWidgets.QSpacerItem(48, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.horizontalLayout_2.addItem(spacerItem5)
        self.horizontalLayout = QtWidgets.QHBoxLayout()
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.label_enter_stock = QtWidgets.QLabel(self.widget_3)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        font.setBold(True)
        font.setWeight(75)
        self.label_enter_stock.setFont(font)
        self.label_enter_stock.setObjectName("label_enter_stock")
        self.horizontalLayout.addWidget(self.label_enter_stock)
        self.lineEdit_enter_stock = QtWidgets.QLineEdit(self.widget_3)
        self.lineEdit_enter_stock.setObjectName("lineEdit_enter_stock")
        self.horizontalLayout.addWidget(self.lineEdit_enter_stock)
        self.button_enter_stock = QtWidgets.QPushButton(self.widget_3)
        self.button_enter_stock.setObjectName("button_enter_stock")
        self.horizontalLayout.addWidget(self.button_enter_stock)
        self.horizontalLayout_2.addLayout(self.horizontalLayout)
        spacerItem6 = QtWidgets.QSpacerItem(178, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.horizontalLayout_2.addItem(spacerItem6)
        self.horizontalLayout_2.setStretch(0, 1)
        self.horizontalLayout_2.setStretch(1, 10)
        self.horizontalLayout_2.setStretch(2, 1)
        self.horizontalLayout_10.addLayout(self.horizontalLayout_2)
        self.verticalLayout_4.addWidget(self.widget_3)
        self.stackedWidget = QtWidgets.QStackedWidget(self.widget_2)
        self.stackedWidget.setObjectName("stackedWidget")
        self.overall_page = QtWidgets.QWidget()
        self.overall_page.setObjectName("overall_page")
        self.gridLayout = QtWidgets.QGridLayout(self.overall_page)
        self.gridLayout.setObjectName("gridLayout")
        self.horizontalLayout_11 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_11.setObjectName("horizontalLayout_11")
        self.verticalLayout_2 = QtWidgets.QVBoxLayout()
        self.verticalLayout_2.setObjectName("verticalLayout_2")
        self.horizontalLayout_3 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_3.setObjectName("horizontalLayout_3")
        self.index_topic = QtWidgets.QLabel(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        font.setBold(True)
        font.setWeight(75)
        self.index_topic.setFont(font)
        self.index_topic.setObjectName("index_topic")
        self.horizontalLayout_3.addWidget(self.index_topic)
        self.index_name = QtWidgets.QLabel(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.index_name.setFont(font)
        self.index_name.setObjectName("index_name")
        self.horizontalLayout_3.addWidget(self.index_name)
        self.verticalLayout_2.addLayout(self.horizontalLayout_3)
        self.horizontalLayout_4 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_4.setObjectName("horizontalLayout_4")
        self.symbol_topic = QtWidgets.QLabel(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        font.setBold(True)
        font.setWeight(75)
        self.symbol_topic.setFont(font)
        self.symbol_topic.setObjectName("symbol_topic")
        self.horizontalLayout_4.addWidget(self.symbol_topic)
        self.symbol_name = QtWidgets.QLabel(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.symbol_name.setFont(font)
        self.symbol_name.setObjectName("symbol_name")
        self.horizontalLayout_4.addWidget(self.symbol_name)
        self.verticalLayout_2.addLayout(self.horizontalLayout_4)
        self.horizontalLayout_5 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_5.setObjectName("horizontalLayout_5")
        self.sector_topic = QtWidgets.QLabel(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        font.setBold(True)
        font.setWeight(75)
        self.sector_topic.setFont(font)
        self.sector_topic.setObjectName("sector_topic")
        self.horizontalLayout_5.addWidget(self.sector_topic)
        self.sector_name = QtWidgets.QLabel(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.sector_name.setFont(font)
        self.sector_name.setObjectName("sector_name")
        self.horizontalLayout_5.addWidget(self.sector_name)
        self.verticalLayout_2.addLayout(self.horizontalLayout_5)
        self.horizontalLayout_6 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_6.setObjectName("horizontalLayout_6")
        self.industry_topic = QtWidgets.QLabel(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        font.setBold(True)
        font.setWeight(75)
        self.industry_topic.setFont(font)
        self.industry_topic.setObjectName("industry_topic")
        self.horizontalLayout_6.addWidget(self.industry_topic)
        self.industry_name = QtWidgets.QLabel(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        font.setBold(False)
        font.setWeight(50)
        self.industry_name.setFont(font)
        self.industry_name.setObjectName("industry_name")
        self.horizontalLayout_6.addWidget(self.industry_name)
        self.verticalLayout_2.addLayout(self.horizontalLayout_6)
        self.horizontalLayout_11.addLayout(self.verticalLayout_2)
        spacerItem7 = QtWidgets.QSpacerItem(40, 20, QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Minimum)
        self.horizontalLayout_11.addItem(spacerItem7)
        self.gridLayout.addLayout(self.horizontalLayout_11, 0, 0, 1, 1)
        self.verticalLayout_6 = QtWidgets.QVBoxLayout()
        self.verticalLayout_6.setObjectName("verticalLayout_6")
        spacerItem8 = QtWidgets.QSpacerItem(20, 40, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Expanding)
        self.verticalLayout_6.addItem(spacerItem8)
        self.label_select_financial = QtWidgets.QLabel(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(14)
        self.label_select_financial.setFont(font)
        self.label_select_financial.setObjectName("label_select_financial")
        self.verticalLayout_6.addWidget(self.label_select_financial)
        self.gridLayout.addLayout(self.verticalLayout_6, 0, 1, 1, 1)
        self.verticalLayout_3 = QtWidgets.QVBoxLayout()
        self.verticalLayout_3.setSpacing(0)
        self.verticalLayout_3.setObjectName("verticalLayout_3")
        self.horizontalLayout_13 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_13.setSpacing(7)
        self.horizontalLayout_13.setObjectName("horizontalLayout_13")
        self.horizontalLayout_8 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_8.setContentsMargins(-1, -1, -1, 0)
        self.horizontalLayout_8.setSpacing(5)
        self.horizontalLayout_8.setObjectName("horizontalLayout_8")
        self.horizontalLayout_7 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_7.setSpacing(5)
        self.horizontalLayout_7.setObjectName("horizontalLayout_7")
        self.button_1w = QtWidgets.QPushButton(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_1w.setFont(font)
        self.button_1w.setCheckable(True)
        self.button_1w.setAutoExclusive(True)
        self.button_1w.setObjectName("button_1w")
        self.horizontalLayout_7.addWidget(self.button_1w)
        self.button_1m = QtWidgets.QPushButton(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_1m.setFont(font)
        self.button_1m.setCheckable(True)
        self.button_1m.setAutoExclusive(True)
        self.button_1m.setObjectName("button_1m")
        self.horizontalLayout_7.addWidget(self.button_1m)
        self.button_3m = QtWidgets.QPushButton(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_3m.setFont(font)
        self.button_3m.setCheckable(True)
        self.button_3m.setAutoExclusive(True)
        self.button_3m.setObjectName("button_3m")
        self.horizontalLayout_7.addWidget(self.button_3m)
        self.button_1y = QtWidgets.QPushButton(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_1y.setFont(font)
        self.button_1y.setCheckable(True)
        self.button_1y.setAutoExclusive(True)
        self.button_1y.setObjectName("button_1y")
        self.horizontalLayout_7.addWidget(self.button_1y)
        self.button_5y = QtWidgets.QPushButton(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_5y.setFont(font)
        self.button_5y.setCheckable(True)
        self.button_5y.setAutoExclusive(True)
        self.button_5y.setObjectName("button_5y")
        self.horizontalLayout_7.addWidget(self.button_5y)
        self.button_max = QtWidgets.QPushButton(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.button_max.setFont(font)
        self.button_max.setCheckable(True)
        self.button_max.setAutoRepeat(False)
        self.button_max.setAutoExclusive(True)
        self.button_max.setObjectName("button_max")
        self.horizontalLayout_7.addWidget(self.button_max)
        self.horizontalLayout_8.addLayout(self.horizontalLayout_7)
        self.comboBox = QtWidgets.QComboBox(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.comboBox.setFont(font)
        self.comboBox.setCursor(QtGui.QCursor(QtCore.Qt.ArrowCursor))
        self.comboBox.setDuplicatesEnabled(False)
        self.comboBox.setObjectName("comboBox")
        self.horizontalLayout_8.addWidget(self.comboBox)
        self.horizontalLayout_13.addLayout(self.horizontalLayout_8)
        self.comboBox_2 = QtWidgets.QComboBox(self.overall_page)
        font = QtGui.QFont()
        font.setFamily("TH Sarabun New")
        font.setPointSize(12)
        self.comboBox_2.setFont(font)
        self.comboBox_2.setObjectName("comboBox_2")
        self.horizontalLayout_13.addWidget(self.comboBox_2)
        self.horizontalLayout_13.setStretch(0, 11)
        self.horizontalLayout_13.setStretch(1, 9)
        self.verticalLayout_3.addLayout(self.horizontalLayout_13)
        self.horizontalLayout_9 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_9.setContentsMargins(-1, 5, -1, 7)
        self.horizontalLayout_9.setSpacing(7)
        self.horizontalLayout_9.setObjectName("horizontalLayout_9")
        self.fig=QWebEngineView(self.overall_page)
        self.fig.load(QUrl("http://localhost:8050"))
        self.fig.setObjectName("fig")
        self.horizontalLayout_9.addWidget(self.fig)
        self.verticalLayout_5 = QtWidgets.QVBoxLayout()
        self.verticalLayout_5.setObjectName("verticalLayout_5")
        self.verticalLayout_5.setStretch(0, 1)
        self.verticalLayout_5.setStretch(1, 1)
        

        self.fig2=QWebEngineView(self.overall_page)
        self.fig2.load(QUrl("http://localhost:8051"))
        self.fig2.setObjectName("fig2")
        self.verticalLayout_5.addWidget(self.fig2)
        self.fig3=QWebEngineView(self.overall_page)
        self.fig3.load(QUrl("http://localhost:8051"))
        self.fig3.setObjectName("fig3")
        self.verticalLayout_5.addWidget(self.fig3)
        self.horizontalLayout_9.addLayout(self.verticalLayout_5)
        self.horizontalLayout_9.setStretch(0, 11)
        self.horizontalLayout_9.setStretch(1, 9)
        self.verticalLayout_3.addLayout(self.horizontalLayout_9)
        self.gridLayout.addLayout(self.verticalLayout_3, 1, 0, 1, 2)
        self.gridLayout.setColumnStretch(0, 11)
        self.gridLayout.setColumnStretch(1, 9)
        self.gridLayout.setRowStretch(1, 10)
        self.stackedWidget.addWidget(self.overall_page)
        self.page_2 = QtWidgets.QWidget()
        self.page_2.setObjectName("page_2")
        self.stackedWidget.addWidget(self.page_2)
        self.page_3 = QtWidgets.QWidget()
        self.page_3.setObjectName("page_3")
        self.stackedWidget.addWidget(self.page_3)
        self.page_4 = QtWidgets.QWidget()
        self.page_4.setObjectName("page_4")
        self.stackedWidget.addWidget(self.page_4)
        self.verticalLayout_4.addWidget(self.stackedWidget)
        self.verticalLayout_4.setStretch(1, 10)
        self.gridLayout_2.addWidget(self.widget_2, 0, 1, 1, 1)
        self.gridLayout_2.setColumnStretch(0, 1)
        self.gridLayout_2.setColumnStretch(1, 15)
        MainWindow.setCentralWidget(self.centralwidget)

        self.retranslateUi(MainWindow)
        self.stackedWidget.setCurrentIndex(0)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "MainWindow"))
        self.label_3.setText(_translate("MainWindow", "TextLabel"))
        self.button_overall_page.setText(_translate("MainWindow", "Overall"))
        self.button_stock_page.setText(_translate("MainWindow", "Stock"))
        self.button_update_page.setText(_translate("MainWindow", "Update"))
        self.button_financial_page.setText(_translate("MainWindow", "Financial"))
        self.button_trending_page.setText(_translate("MainWindow", "Trending"))
        self.label_enter_stock.setText(_translate("MainWindow", "Enter Stock Symbol"))
        self.button_enter_stock.setText(_translate("MainWindow", "Enter"))
        self.index_topic.setText(_translate("MainWindow", "Index :"))
        self.index_name.setText(_translate("MainWindow", "SET"))
        self.symbol_topic.setText(_translate("MainWindow", "Symbol :"))
        self.symbol_name.setText(_translate("MainWindow", "PTT"))
        self.sector_topic.setText(_translate("MainWindow", "Sector :"))
        self.sector_name.setText(_translate("MainWindow", "Resorce"))
        self.industry_topic.setText(_translate("MainWindow", "Industry :"))
        self.industry_name.setText(_translate("MainWindow", "Oil & Power"))
        self.label_select_financial.setText(_translate("MainWindow", "Financial statement :"))
        self.button_1w.setText(_translate("MainWindow", "1w"))
        self.button_1m.setText(_translate("MainWindow", "1m"))
        self.button_3m.setText(_translate("MainWindow", "3m"))
        self.button_1y.setText(_translate("MainWindow", "1y"))
        self.button_5y.setText(_translate("MainWindow", "5y"))
        self.button_max.setText(_translate("MainWindow", "max"))


if __name__ == "__main__":
    import sys
    app = QtWidgets.QApplication(sys.argv)
    MainWindow = QtWidgets.QMainWindow()
    ui = Ui_MainWindow()
    ui.setupUi(MainWindow)
    MainWindow.show()
    sys.exit(app.exec_())
